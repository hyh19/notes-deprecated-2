# 第 5 章 集合类

---

[TOC]

## 5.3 `List`

### 5.3.1 创建不可变 `List`

`listOf` 函数创建的 `List` 都是只读的（也就是不可变的 immutable）、可序列化的。

```bash
# 创建没有元素的 List
>>> val list: List<Int> = listOf()
>>> list
[]
>>> list::class
class kotlin.collections.EmptyList
```

```bash
# 注意：变量的类型不能省略，因为 listOf 是泛型函数。
>>> val list = listOf()
error: type inference failed: Not enough information to infer parameter T in inline fun <T> listOf(): List<T>
Please specify it explicitly.

val list = listOf()
           ^
```

```bash
# 创建只有一个元素的 List
>>> val list = listOf(1)
>>> list::class
class java.util.Collections$SingletonList
```

```bash
# 创建有多个元素的 List
>>> val list = listOf(10, 20, 30)
>>> list
[10, 20, 30]
>>> list::class
class java.util.Arrays$ArrayList
```

```bash
# 直接使用 arrayListOf 函数创建 Java 中的 ArrayList 对象实例
>>> val list = arrayListOf(10, 20, 30)
>>> list
[10, 20, 30]
>>> list::class
class java.util.ArrayList
```

### 5.3.2 创建可变集合的 `MutableList`

```bash
>>> val list = mutableListOf(10, 20, 30)
>>> list
[10, 20, 30]
>>> list::class
class java.util.ArrayList
>>> list.add(40)
true
>>> list
[10, 20, 30, 40]
```

```bash
>>> val list = mutableListOf<Int>()
>>> list
[]
>>> list::class
class java.util.ArrayList
>>> list.add(100)
true
>>> list
[100]
```

```bash
>>> val list = mutableListOf(10)
>>> list
[10]
>>> list::class
class java.util.ArrayList
>>> list.add(20)
true
>>> list
[10, 20]
```

```bash
>>> val list = listOf(10, 20, 30)
>>> list.add(40)
error: unresolved reference: add
list.add(40)
     ^

# 不可变 List 转换成可变
>>> val mlist = list.toMutableList()
>>> mlist.add(40)
true
>>> mlist
[10, 20, 30, 40]
```

### 5.3.3 遍历 `List` 元素

使用 `Iterator` 迭代器

```bash
>>> val list = listOf(10, 20, 30)
>>> list
[10, 20, 30]
>>> val iterator = list.iterator()
>>> iterator
java.util.AbstractList$Itr@2d5b3f1a
>>> iterator.hasNext()
true
>>> iterator.next()
10
>>> iterator.next()
20
>>> iterator.next()
30
>>> iterator.next()
java.util.NoSuchElementException
        at java.util.AbstractList$Itr.next(AbstractList.java:364)
```

使用 `forEach` 函数

```bash
>>> val list = listOf(10, 20, 30)
>>> list
[10, 20, 30]
# 以下三种写法等价
>>> list.forEach { println(it) } # 尾随闭包
10
20
30
>>> list.forEach({ println(it) })
10
20
30
>>> list.forEach(::println)
10
20
30
```
